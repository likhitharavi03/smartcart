{% extends "user/base.html" %}

{% block title %}User Profile{% endblock %}

{% block content %}
<div class="center-wrapper">
<div style="display:flex; justify-content:center; margin-top:30px;">
    <div class="card" style="width:400px; padding:20px;">

        <h2 style="text-align:center;">User Profile</h2>
        <br>

        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% for category, message in messages %}
                <p style="
                    text-align:center;
                    color:{% if category == 'danger' %}red{% else %}green{% endif %};
                ">
                    {{ message }}
                </p>
            {% endfor %}
        {% endwith %}

        <!-- Profile Image -->
        <div style="text-align:center;">
            {% if user.profile_image %}
                <img src="{{ url_for('static', filename='uploads/user_profiles/' ~ user.profile_image) }}"
                     width="120" height="120"
                     style="border-radius:50%; object-fit:cover;">
            {% else %}
                <img src="{{ url_for('static', filename='images/users_default.png') }}"
                     width="120" height="120"
                     style="border-radius:50%; object-fit:cover;">
            {% endif %}
        </div>

        <br>

        <!-- Update Form -->
        <form method="POST"
              action="{{ url_for('user_profile_update') }}"
              enctype="multipart/form-data">

            <label>Name</label>
            <input type="text" name="name"
                   value="{{ user.name }}"
                   required style="width:100%; padding:6px;">

            <label>Email</label>
            <input type="email" name="email"
                   value="{{ user.email }}"
                   required style="width:100%; padding:6px;">

            <label>New Password (optional)</label>
            <input type="password" name="password"
                   style="width:100%; padding:6px;">

            <label>Upload New Profile Image (optional)</label>
            <input type="file"
                   name="profile_image"
                   accept="image/*">

            <button type="submit"
                    style="width:100%; padding:8px; margin-top:10px;">
                Update Profile
            </button>
        </form>

        <div style="text-align:center; margin-top:10px;">
            <a href="{{ url_for('user_home') }}">
                <b>‚Üê Back to Home</b>
            </a>
        </div>

    </div>
</div>
</div>
{% endblock %}
